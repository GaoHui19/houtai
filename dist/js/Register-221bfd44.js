import{r as A,a as y}from"./regexp-3f5a0311.js";import{a as k,d as S,D as x}from"./index-edcb0a67.js";import{e as R}from"./crypto-17c217c0.js";import{u as P}from"./useSmsCaptcha-088816da.js";import{_ as U}from"./plugin-vue_export-helper-c27b6911.js";import{E as q,a as c,l as C,m as g,U as a,M as l,p as f,u as _,T as I,R as N,S as B,af as n,aA as $,aB as M}from"./vue-c376286b.js";import"./lodash-683eb0bb.js";const T=d=>($("data-v-6b49b9d2"),d=d(),M(),d),K={class:"register"},L=T(()=>f("p",{class:"register-header"},"账号注册",-1)),j={class:"flex"},z=B(" 获取验证码 "),G={key:0},H={class:"flex"},J=B("注册"),O=B("使用已有账号登录"),Q=q({__name:"Register",setup(d){const p=c(),m=c(!1),u=c({username:"",password:"",checkPassword:"",mobile:"",captcha:""}),v=k(),{captchaDisabled:F,captchaCount:b,sendCaptcha:h}=P(),D={username:[{required:!0,message:"账号不能为空"}],password:[{required:!0,message:"请输入密码"},{pattern:A,message:"密码需要为6~20位，且需要包含数字和字母",trigger:"blur"}],checkPassword:[{required:!0,message:"请再次输入密码",trigger:"blur"},{validator(o,e){return e===u.value.password},message:"两次输入的密码不一致",trigger:"blur"}],mobile:[{required:!0,message:"手机号码不能为空"},{pattern:y,message:"手机号码格式不正确",trigger:"blur"}],captcha:[{required:!0,message:"请填写验证码"}]},w=async()=>{var o;(o=p.value)==null||o.validateField("mobile",e=>{e&&h({mobile:u.value.mobile})})},E=()=>{var o;(o=p.value)==null||o.validate(async e=>{e&&(m.value=!0,await S.portal.register(u.value),window.$message.success("注册成功！"),m.value=!1,v.login({username:u.value.username,password:R(u.value.password,x)}))})};return(o,e)=>{const r=n("el-input"),t=n("el-form-item"),i=n("el-button"),V=n("el-form");return C(),g("div",K,[L,a(V,{ref_key:"formRef",ref:p,model:u.value,rules:D,"label-width":80},{default:l(()=>[a(t,{label:"账号",prop:"username"},{default:l(()=>[a(r,{modelValue:u.value.username,"onUpdate:modelValue":e[0]||(e[0]=s=>u.value.username=s),placeholder:"请输入账号"},null,8,["modelValue"])]),_:1}),a(t,{label:"密码",prop:"password"},{default:l(()=>[a(r,{modelValue:u.value.password,"onUpdate:modelValue":e[1]||(e[1]=s=>u.value.password=s),type:"password",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),a(t,{label:"确认密码",prop:"checkPassword"},{default:l(()=>[a(r,{modelValue:u.value.checkPassword,"onUpdate:modelValue":e[2]||(e[2]=s=>u.value.checkPassword=s),type:"password",placeholder:"请再次输入密码"},null,8,["modelValue"])]),_:1}),a(t,{label:"手机号",prop:"mobile"},{default:l(()=>[a(r,{modelValue:u.value.mobile,"onUpdate:modelValue":e[3]||(e[3]=s=>u.value.mobile=s),placeholder:"请填写手机号码"},null,8,["modelValue"])]),_:1}),a(t,{label:"验证码",prop:"captcha"},{default:l(()=>[f("div",j,[a(r,{modelValue:u.value.captcha,"onUpdate:modelValue":e[4]||(e[4]=s=>u.value.captcha=s),placeholder:"请输入短信验证码"},null,8,["modelValue"]),a(i,{class:"ml-5",type:"info",disabled:_(F),onClick:w},{default:l(()=>[z,_(F)?(C(),g("span",G,"("+I(_(b))+"s)",1)):N("",!0)]),_:1},8,["disabled"])])]),_:1}),a(t,null,{default:l(()=>[f("div",H,[a(i,{class:"w-35",type:"primary",loading:m.value,onClick:E},{default:l(()=>[J]),_:1},8,["loading"]),a(i,{class:"ml-5",type:"primary",link:"",onClick:e[5]||(e[5]=s=>o.$router.push("/login"))},{default:l(()=>[O]),_:1})])]),_:1})]),_:1},8,["model"])])}}}),se=U(Q,[["__scopeId","data-v-6b49b9d2"]]);export{se as default};
